---
redirect_from:
  - "/mordor-erebor"
title: |-
  Erebor
pagenum: 4
prev_page:
  url: /mordor_shire.html
next_page:
  url: /export_mordor.html
suffix: .md
search: erebor com environment windows blacksmith mordor etw users win event log file silketw ubuntu helk img src images network administrator client github hunters forge config events providers information every endpoints via png user server linux data helks password blob master aws cfn parameters used deploy project default xml enable provided trace sessions real readthedocs io en latest jpeg designed replicate very small essential devices colllect adversarial activities running collect telemetry design platform version purpose fqdn ip address main dc hfdc hr bbaggins toakenshield acct kfili collector wecserver analysis red team c rto firstnamelastnamesamdepartmentjobtitlepasswordidentity bilbobagginsbbagginshuman resourceshr directormyprcus thorinoakenshieldtoakenshieldit supportciodurngskng domain admins

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Erebor</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="images/network-erebor.jpeg"></p>
<p>This mordor environment was designed to replicate a very small network with the essential devices to colllect information from adversarial activities.
This environment is a Windows environment with SilkETW running on every endpoints to collect ETW telemetry via the event log.</p>
<h2 id="Network-Design">Network Design<a class="anchor-link" href="#Network-Design"> </a></h2><p><img src="images/mordor-erebor-environment.png"></p>
<h2 id="Endpoints-To-Users">Endpoints To Users<a class="anchor-link" href="#Endpoints-To-Users"> </a></h2><table>
<thead><tr>
<th style="text-align:left">Platform</th>
<th style="text-align:left">Version</th>
<th style="text-align:left">Purpose</th>
<th style="text-align:left">FQDN</th>
<th style="text-align:left">IP Address</th>
<th style="text-align:left">Main User</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Windows</td>
<td style="text-align:left">Win 2019</td>
<td style="text-align:left">DC</td>
<td style="text-align:left">HFDC01.erebor.com</td>
<td style="text-align:left">10.0.1.5</td>
<td style="text-align:left">Administrator</td>
</tr>
<tr>
<td style="text-align:left">Windows</td>
<td style="text-align:left">Win 10</td>
<td style="text-align:left">Client</td>
<td style="text-align:left">HR001.erebor.com</td>
<td style="text-align:left">10.0.1.106</td>
<td style="text-align:left">bbaggins</td>
</tr>
<tr>
<td style="text-align:left">Windows</td>
<td style="text-align:left">Win 10</td>
<td style="text-align:left">Client</td>
<td style="text-align:left">IT001.erebor.com</td>
<td style="text-align:left">10.0.1.105</td>
<td style="text-align:left">toakenshield</td>
</tr>
<tr>
<td style="text-align:left">Windows</td>
<td style="text-align:left">Win 10</td>
<td style="text-align:left">Client</td>
<td style="text-align:left">ACCT001.erebor.com</td>
<td style="text-align:left">10.0.1.100</td>
<td style="text-align:left">kfili</td>
</tr>
<tr>
<td style="text-align:left">Windows</td>
<td style="text-align:left">Win 2019</td>
<td style="text-align:left">Log Collector</td>
<td style="text-align:left">WECServer.erebor.com</td>
<td style="text-align:left">10.0.1.102</td>
<td style="text-align:left">Administrator</td>
</tr>
<tr>
<td style="text-align:left">Windows</td>
<td style="text-align:left">Win 2019</td>
<td style="text-align:left">File Server</td>
<td style="text-align:left">FILE001.erebor.com</td>
<td style="text-align:left">10.0.1.103</td>
<td style="text-align:left">Administrator</td>
</tr>
<tr>
<td style="text-align:left">Linux</td>
<td style="text-align:left">Ubuntu 18</td>
<td style="text-align:left">Data Analysis</td>
<td style="text-align:left">HELK</td>
<td style="text-align:left">10.0.1.6</td>
<td style="text-align:left">ubuntu</td>
</tr>
<tr>
<td style="text-align:left">Linux</td>
<td style="text-align:left">Ubuntu 18</td>
<td style="text-align:left">Red Team C2</td>
<td style="text-align:left">RTO</td>
<td style="text-align:left">10.0.1.8</td>
<td style="text-align:left">ubuntu</td>
</tr>
</tbody>
</table>
<h2 id="Windows-Users-Information">Windows Users Information<a class="anchor-link" href="#Windows-Users-Information"> </a></h2><table>
<thead><tr>
<th style="text-align:left">FirstName</th>
<th style="text-align:left">LastName</th>
<th style="text-align:left">Sam</th>
<th style="text-align:left">Department</th>
<th style="text-align:left">JobTitle</th>
<th style="text-align:left">Password</th>
<th style="text-align:left">Identity</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Bilbo</td>
<td style="text-align:left">Baggins</td>
<td style="text-align:left">bbaggins</td>
<td style="text-align:left">Human Resources</td>
<td style="text-align:left">HR Director</td>
<td style="text-align:left">MyPr3c10us!</td>
<td style="text-align:left">Users</td>
</tr>
<tr>
<td style="text-align:left">Thorin</td>
<td style="text-align:left">Oakenshield</td>
<td style="text-align:left">toakenshield</td>
<td style="text-align:left">IT Support</td>
<td style="text-align:left">CIO</td>
<td style="text-align:left">Dur1ngsK1ng!</td>
<td style="text-align:left">Domain Admins</td>
</tr>
<tr>
<td style="text-align:left">Kili</td>
<td style="text-align:left">Fili</td>
<td style="text-align:left">kfili</td>
<td style="text-align:left">Accounting</td>
<td style="text-align:left">VP</td>
<td style="text-align:left">T0d@y!2019</td>
<td style="text-align:left">Users</td>
</tr>
<tr>
<td style="text-align:left">Silk</td>
<td style="text-align:left">Etw</td>
<td style="text-align:left">silksvc</td>
<td style="text-align:left">IT Support</td>
<td style="text-align:left">Service Account</td>
<td style="text-align:left">Fr33T3l3m3try!</td>
<td style="text-align:left">Users</td>
</tr>
<tr>
<td style="text-align:left">Administrator</td>
<td style="text-align:left"></td>
<td style="text-align:left">Administrator</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
<td style="text-align:left">P1ls3n!</td>
<td style="text-align:left">Users</td>
</tr>
</tbody>
</table>
<h2 id="HELK-User-Informatiom">HELK User Informatiom<a class="anchor-link" href="#HELK-User-Informatiom"> </a></h2><p>You can update the HELK's password in the <a href="https://github.com/hunters-forge/Blacksmith/blob/master/aws/mordor/cfn-parameters/erebor/helk-server-parameters.json">HELK's paramaters file</a> used to deploy the environment.
This file is hosted by the project <a href="https://github.com/hunters-forge/Blacksmith">Blacksmith</a> since it is the official repo for all the templates used to deploy every mordor environment.</p>
<ul>
<li>Default Username: helk</li>
<li>Default Password: hunt1ng!</li>
</ul>
<h2 id="Data-Sources-Collected">Data Sources Collected<a class="anchor-link" href="#Data-Sources-Collected"> </a></h2><p>SilkETW Service Config:</p>
<ul>
<li><a href="https://github.com/hunters-forge/Blacksmith/blob/master/aws/mordor/cfn-files/configs/erebor/erebor_SilkServiceConfig.xml">https://github.com/hunters-forge/Blacksmith/blob/master/aws/mordor/cfn-files/configs/erebor/erebor_SilkServiceConfig.xml</a></li>
</ul>
<p>I put together the image below to show you how SilkETW leverages the ETW model to enable ETW events for collection, filtering and ingestion via the event log.</p>
<p><img src="images/mordor-erebor-silketw.png"></p>
<ul>
<li>It reads the contents of the provided SilkServiceConfig.xml config to identify the ETW providers it needs to enable and with what filters.</li>
<li>It enables the ETW providers defined in the config file.</li>
<li>It creates event trace sessions and subscribes them to the ETW providers</li>
<li>It consumes events from the event trace sessions in real time</li>
<li>It writes consumed events to the SilkService Log event log in real time</li>
</ul>
<h2 id="Environment-Deployment">Environment Deployment<a class="anchor-link" href="#Environment-Deployment"> </a></h2><p>The <a href="https://blacksmith.readthedocs.io/en/latest/">Blacksmith Project</a> is responsible for deploying this environment.
Therefore, you can follow the instructions provided in <a href="https://blacksmith.readthedocs.io/en/latest/mordor_erebor.html">here</a></p>

</div>
</div>
</div>
</div>

 


    </main>
    